{% extends "backoffice/base.html" %}
{% block title %}Admin · Tournaments{% endblock %}
{% block content %}
<div class="container my-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Tournaments (Admin)</h2>
    {% if can_create %}
      <a class="btn btn-primary" href="{% url 'tournaments:tournament_new' %}">
        <i class="bi bi-plus-lg"></i> New Tournament
      </a>
    {% endif %}
  </div>

  {% if tournaments %}
    <div class="row g-3">
      {% for t in tournaments %}
        <div class="col-md-6 col-xl-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body d-flex flex-column">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <h5 class="card-title mb-1">{{ t.name }}</h5>
                  <div class="text-muted small">
                    {{ t.sport.name }} · {{ t.get_ttype_display }}
                  </div>
                </div>
                <span class="badge text-bg-light small">{{ t.start_date }} → {{ t.end_date }}</span>
              </div>

              <div class="mt-3 d-flex gap-2">
                <a class="btn btn-outline-primary btn-sm" href="{% url 'tournaments:admin_detail' t.id %}">Open</a>
                {% if can_edit_tournament %}
                  <a class="btn btn-outline-secondary btn-sm" href="{% url 'tournaments:tournament_edit' t.id %}">Edit</a>
                {% endif %}
                {% if can_delete_tournament %}
                  <form method="post" action="{% url 'tournaments:tournament_delete' t.id %}" class="ms-auto"
                        onsubmit="return confirm('Delete \"{{ t.name }}\"? This cannot be undone.');">
                    {% csrf_token %}
                    <button class="btn btn-outline-danger btn-sm">Delete</button>
                  </form>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-secondary">No tournaments yet.</div>
  {% endif %}
</div>
{% endblock %}
