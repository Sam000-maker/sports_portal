{% extends "base.html" %}
{% block title %}Team {{ team.name }}{% endblock %}
{% block content %}
<div class="container my-5">
  <h2 class="mb-4">{{ team.name }} <small class="text-muted">({{ team.sport.name }})</small></h2>
  {% if messages %}
    {% for msg in messages %}
      <div class="alert alert-{{ msg.tags }}">{{ msg }}</div>
    {% endfor %}
  {% endif %}

  <p><strong>Captain:</strong> {{ team.created_by.username }}</p>

  <h5>Members:</h5>
  <ul>
    {% for m in members %}
      <li>{{ m.user.username }}{% if m.user_id == team.created_by_id %} <em>(Captain)</em>{% endif %}</li>
    {% endfor %}
  </ul>

  {% if pending_invites and request.user == team.created_by %}
    <h5>Pending Invitations:</h5>
    <ul>
      {% for inv in pending_invites %}
        <li>{{ inv.user.username }} (Invited)</li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if invite_form %}
    <hr>
    <h5>Invite a Player:</h5>
    <form method="post">
      {% csrf_token %}
      <div class="mb-3">
        {{ invite_form.user.label_tag }}  
        {{ invite_form.user }}
        {% for error in invite_form.user.errors %}<div class="text-danger">{{ error }}</div>{% endfor %}
      </div>
      <button type="submit" class="btn btn-secondary">Send Invite</button>
    </form>
  {% endif %}

  {% if user_invited %}
    <hr>
    <form method="post" action="{% url 'players:team_accept' team.id %}">
      {% csrf_token %}
      <button type="submit" class="btn btn-success">Accept Invitation</button>
      {# For decline, one could implement a similar form to remove the invite #}
    </form>
  {% endif %}
</div>
{% endblock %}
